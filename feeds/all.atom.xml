<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Liuw's Thinkpad</title><link href="http://blog.liuw.name/" rel="alternate"></link><link href="http://blog.liuw.name/feeds/all.atom.xml" rel="self"></link><id>http://blog.liuw.name/</id><updated>2014-05-05T23:40:00+01:00</updated><entry><title>Fix Debian Wheezy's Openswan Regression with Apple Devices</title><link href="http://blog.liuw.name/fix-debian-wheezys-openswan-regression-with-apple-devices.html" rel="alternate"></link><updated>2014-05-05T23:40:00+01:00</updated><author><name>Wei Liu</name></author><id>tag:blog.liuw.name,2014-05-05:fix-debian-wheezys-openswan-regression-with-apple-devices.html</id><summary type="html">&lt;p&gt;In late March Debian Security team pushed a security update to Openswan package in Wheezy. My Macbook Air cannot connect to Openswan anymore after upgrading.&lt;/p&gt;
&lt;p&gt;I searched a bit and found out that somebody already filed a bug report on Debian bug tracker: &lt;a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=744717"&gt; bug 744717 &lt;/a&gt;. There's also a report on Openswan's Github page to confirm this bug: &lt;a href="https://github.com/xelerance/Openswan/issues/78"&gt;issue 78&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;On Debian bug tracker a user named Liu DongMiao provided a patch and it was reported to work. I had a look at that patch but didn't quite like it, because it leaked a macro in C file, which is not a proper fix to me.&lt;/p&gt;
&lt;p&gt;The root cause of the problem is confilict in header file. Debian Security team removed ISAKMP_NEXT_NATD_BADDRAFTS. Then they had to comment out or remove some code to handle that flag, of which Apple devices make use. Unfortunately I cannot get Apple to fix their code so I have to fix mine.&lt;/p&gt;
&lt;p&gt;The fix is simplier than I thought. I compared upstream Openswan 2.6.37 with Wheezy's patched version, then restored the original flag and those code snippets. I was worried that the overriden new flag was used in code but it wasn't. I didn't touch changelog or version number of that package, so that when a new package is out it can be automatically updated when the maintainers push a new package to fix that bug.&lt;/p&gt;
&lt;p&gt;I have my &lt;a href="../files/fix-osx-baddraft-flag.patch"&gt;patch&lt;/a&gt; attached. If you want to know how to rebuild Debian package, &lt;a href="https://www.debian.org/doc/manuals/maint-guide/index.en.html"&gt;Debian New Maintainers' Guide&lt;/a&gt; is a good starting point.&lt;/p&gt;</summary></entry><entry><title>2012年终总结</title><link href="http://blog.liuw.name/2012-year-end-review.html" rel="alternate"></link><updated>2012-12-28T20:40:00+00:00</updated><author><name>Wei Liu</name></author><id>tag:blog.liuw.name,2012-12-28:2012-year-end-review.html</id><summary type="html">&lt;p&gt;由于2012年12月31日是周一，是一个工作日，估计到时也没有时间来写blog了，所以趁着周末来写一下吧。&lt;/p&gt;
&lt;p&gt;上一个基于Wordpress的blog，由于VPS到期，大家都没打算继续在其上投资，所以下线了。之后我便萌生了改用如Pelican、Octopress、Hyde以及Jekyll这样的静态blog系统的想法。在七到九月间进行了一些尝试，但是鉴于Wordpress中使用了一些插件以及一些格式上的问题，旧文章的转换效果总是不尽如人意。而我自己又比较懒于重复造轮子，所以重新开blog的计划就一直拖到了现在。&lt;/p&gt;
&lt;p&gt;现今已经是年末，再不动手只怕这个事情要从Todo list移动到Undo list，最后到Never-do list了，所以还是快点动手吧。现在选了自己比较熟悉的Python做的Pelican，先从头开始写。旧blog中的一些文章，若是我想到比较有用或者有意思的，会手工转到Pelican中来。&lt;/p&gt;
&lt;p&gt;每个人的一年，都有不同的精彩和失落，但是最后总可以总结到一句话：如人饮水，冷暖自知。文字写多了，也不免变成流水账，乏味得让人犯困。所以鸡毛蒜皮的事情我就不写了，只记重要的事情。&lt;/p&gt;
&lt;p&gt;一到四月的时候，在剑桥实习。春节自然是没有回家，虽然有12天的假期，但是机票委实太贵，加之去年十一月末出来的时候已经在家待过一周，所以最后还是选择留下继续工作。总的来说，实习的表现还不错。当时的想法就是挑战一下自己看能不能在四个月之内把这么大的一个坑填上，可惜network I/O这个坑实在太大，写了四轮patch还是才只能说是刚刚开始，所以最后只能先把这个坑留着了。期间fix一些小bug什么的，基本不在话下。&lt;/p&gt;
&lt;p&gt;四月初，因为实验室项目的需要，回国后直接高铁回到武汉，二十多个小时没有休息。回到武汉后第二天又马上开始工作，我当时都觉得自己精力真好。项目顺利过关后，开始着手毕业工作。虽然很幸运（不幸）地被抽中到学校进行论文查重，由于论文都是自己慢慢敲的，所以顺利过关。不过文章里面说的系统没有能完全做好，代码也不见了，此为又一憾事。期间的另外一个遗憾就是曾经答应过一个华科的同学，说是回来后到华科和他们聊一聊，最后还是没能成行，最后只能和他们说一声对不起了。&lt;/p&gt;
&lt;p&gt;七月底，转战杭州，加入淘宝核心系统部。我被分到多隆的手下，接手毕玄主导的T4系统的一些开发维护工作。平时的工作不算繁重，公司大了有各种各样的限制，所以总体效率不算高。由于T4也有内核方面的改动，所以也认识了内核组的高阳和含黛，成为不错的朋友。加上参加“洗脑”培训以及技术培训，也算是认识了不少的朋友。可以说，认识的这些主管、技术大牛以及各个业务线、产品线的朋友，是我在淘宝最大的收获。技术方面的长进相对来说少一点，最大的收获就是体验到了互联网公司的技术氛围：迭代快、要落地、在优雅和速度之间取得平衡。&lt;/p&gt;
&lt;p&gt;在再三思虑之后，我还是决定趁着年轻的时候出来闯荡一下，所以最后还是离开了淘宝，接受了Platform Team的offer。这里也多得了多隆的支持，我一提出来，他很爽快地答应了。我想这就是所谓的君子之交吧，虽然他是我的上级，但是平时他总是待我如朋友一般，也很为我的个人发展着想，真的要多谢他。&lt;/p&gt;
&lt;p&gt;于是在回家休息半个月之后，又登上了来英国的飞机。有趣的是，我到达的日期只和去年差了四天。再次回来，心里早已没有初来乍到的那种忐忑。轻车熟路地入职、找房子、搬家，一切的一切，都是如此的按部就班。Platform Team甚至连我的桌子都留着给我原封不动。回来之后马上又开始挖一个新的坑，希望2013年一月的时候能填完吧。&lt;/p&gt;
&lt;p&gt;总结一下，2012是很折腾的一年，顺利毕业，走南闯北上山下海。外面的世界很精彩，我从很多不同的人身上学到了不同的东西，看了很多以前没有看过的风景；外面的世界也很无奈，我不得不面对相伴多年的两个人分道扬镳的事实。最后还是那一句话，如人饮水，冷暖自知。希望2013年里面，所有我爱的人和爱我的人，所有认识的和不认识的朋友，都能越过越好；所有知道和不知道的幸福，都能越来越多；所有了解和不了解的苦难，都会越来越少。&lt;/p&gt;
&lt;p&gt;此致&lt;/p&gt;</summary></entry></feed>